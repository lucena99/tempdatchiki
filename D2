FROM atnurgaliev/firebird2.5

USER root

ENV DEBIAN_FRONTEND=noninteractive

RUN apt-get -y -q update

RUN apt-get install -y software-properties-common

RUN apt-get install -y apt-transport-https ca-certificates
RUN add-apt-repository ppa:webupd8team/java
RUN apt-get -y -q update
RUN echo oracle-java8-installer shared/accepted-oracle-license-v1-1 select true | /usr/bin/debconf-set-selections
RUN apt-get -y -q update
RUN apt-get -y -q install oracle-java8-installer
RUN update-java-alternatives -s java-8-oracle

RUN ln -sf /usr/share/zoneinfo/Europe/Moscow /etc/localtime && \
    echo "Europe/Moscow" > /etc/timezone

RUN mkdir -p /app
WORKDIR /app
COPY target/tempdatchiki.war /app/

RUN mkdir -p /resources
COPY src/main/resources/log4j2.xml /resources/

RUN mkdir -p /log

CMD [ "java", \
    "-Dlog4j.configurationFile=file:/resources/log4j2.xml", \
    "-Dport=${PORT}", \
    "-Xmx1G", \
    "-DlogPath=/log", \
    "-jar", "/app/tempdatchiki.war"]